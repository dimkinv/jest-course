<!doctype html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

	<title>reveal.js</title>

	<link rel="stylesheet" href="dist/reset.css">
	<link rel="stylesheet" href="dist/reveal.css">
	<link rel="stylesheet" href="dist/theme/black.css" id="theme">

	<!-- Theme used for syntax highlighted code -->
	<link rel="stylesheet" href="plugin/highlight/monokai.css" id="highlight-theme">
	<script>
		document.write('<script src="http://' + (location.host || 'localhost').split(':')[0] +
			':35729/livereload.js?snipver=1"></' + 'script>')
	</script>
	<style>
		.noborder td{
			border: none !important;
		}
		.layer {
			font-size: 18px;
			height: 80px;
			width: 120px;
			border: 3px solid red;
			display: flex;
			align-items: center;
			justify-content: center;
			margin-left: 20px;
		}

		.arrow {
			margin-top: 20px;
			height: 10px;
			background: green;
			position: relative;
		}

		.arrow::after {
			top: -10px;
			right: -15px;
			display: block;
			content: '';
			position: absolute;
			border-top: 15px solid transparent;
			border-bottom: 15px solid transparent;
			border-left: 15px solid green;
		}

		.diagram {
			align-items: center;
			display: flex;
		}

		.diagram aside {
			height: 100px;
			width: 10px;
			background: green;
			margin-left: 20px;
		}
	</style>
</head>

<body>
	<div class="reveal">
		<div class="slides">
			<section>
				<h2>UnitTests with Jest - Basic</h2>
			</section>
			<section>
				<h2>Super Fast Orbital Mechanics Intro</h2>
				<p>This is what most of us think happen!</p>
				<img src="../../assets/rocket-vertical.avif" />
			</section>
			<section>
				<h2>Super Fast Orbital Mechanics Intro</h2>
				<p>This is what actually happen</p>
				<img width="600" src="../../assets/launch-spacex.jpeg" />
			</section>
			<section>
				<h2>Super Fast Orbital Mechanics Intro</h2>
				<p>How orbits work</p>
				<img width="500" src="../../assets/1200px-Newton_Cannon.svg.png" />
			</section>
			<section>
				<h2>Super Fast Orbital Mechanics Intro</h2>
				<p>Types of orbits</p>
				<img src="../../assets/orbits.jpeg" />
			</section>
			<section>
				<h3>So why to test anyway?</h3>
				<div style="display:flex;justify-content: center">
					<div class="fragment" style="margin-right:20px;">
						<div>Ariane 5</div>
						<img class="reset-img" height="500" src="../../assets/ariane5.png" />
					</div>
					<div class="fragment">
						<div>Ariane 5 T+00:39 </div>
						<img class="reset-img" height="500" src="../../assets/ariane5-accident.jpg" />
					</div>
			</section>
			<section>
				<p>...software <b style="color:red;">exception</b> was caused during execution of a data conversion from
					64-bit
					floating point to 16-bit signed integer value...</p>
				<p class="fragment">...function was not tested under simulated Ariane 5 flight conditions, and the
					design error was
					not discovered.</p>
				<div style="text-align: right;font-style: italic; font-size:14px">Official Inquiry Board report</div>
			</section>
			<section>
				<h3 style="color:red">~500 USD bug!</h3>
			</section>
			<section>
				<h3>Different types of tests</h3>
				<div class="r-stack">
					<div class="diagram fragment fade-out" data-fragment-index="0">
						<div class="layer">client</div>
						<div class="layer">gateway</div>
						<div class="layer">controller</div>
						<div class="layer">service</div>
						<div class="layer">DAL</div>
						<div class="layer">DB</div>
					</div>
					<div class="diagram fragment fade-in-then-out" data-fragment-index="0">
						<aside></aside>
						<div class="layer">client</div>
						<div class="layer">gateway</div>
						<div class="layer">controller</div>
						<div class="layer">service</div>
						<div class="layer">DAL</div>
						<div class="layer">DB</div>
						<aside></aside>
					</div>
					<div class="diagram fragment fade-in-then-out" data-fragment-index="1">
						<div class="layer">client</div>
						<aside></aside>
						<div class="layer">gateway</div>
						<div class="layer">controller</div>
						<div class="layer">service</div>
						<div class="layer">DAL</div>
						<div class="layer">DB</div>
						<aside></aside>
					</div>
					<div class="diagram fragment fade-in-then-out" data-fragment-index="2">
						<div class="layer">client</div>
						<div class="layer">gateway</div>
						<aside></aside>
						<div class="layer">controller</div>
						<div class="layer">service</div>
						<aside></aside>
						<div class="layer">DAL</div>
						<div class="layer">DB</div>
					</div>
					<div class="diagram fragment fade-in-then-out" data-fragment-index="3">
						<div class="layer">client</div>
						<div class="layer">gateway</div>
						<aside></aside>
						<div class="layer">controller</div>
						<aside></aside>
						<div class="layer">service</div>
						<div class="layer">DAL</div>
						<div class="layer">DB</div>
					</div>
					<div class="diagram fragment fade-in" data-fragment-index="4">
						<aside></aside>
						<div class="layer">client</div>
						<aside></aside>
						<div class="layer">gateway</div>
						<div class="layer">controller</div>
						<div class="layer">service</div>
						<div class="layer">DAL</div>
						<div class="layer">DB</div>
					</div>
				</div>
				<div class="arrow"></div>
			</section>
			<section>
				<h3><img class="reset-img" height="80" style="vertical-align: middle;" src="../../assets/jest.png" /> Jest
					All-in-One</h3>
				<ul style="list-style: none">
					<li>Assertion library</li>
					<li>Test runner</li>
					<li>CLI tool</li>
					<li>Coverage library</li>
					<li>Blazing fast</li>
				</ul>
			</section>
			<section data-transition="slide-in none-out">
				<img class="reset-img" height="100" src="" ../../assets/jest.png" />
				<div style="display: inline-block;width:4px;height:100px;margin:15px 0"></div>
				<div style="display:inline-block;">
					<img class="reset-img" height="100" src="../../assets/chaijs.png" />
					<img class="reset-img" height="100" src="../../assets/karma.svg" />
					<img class="reset-img" height="100" src="../../assets/jasmine.png" />
					<img class="reset-img" height="100" src="../../assets/mocha.svg" />
					<img class="reset-img" height="100" src="../../assets/phantomjs.png" />
					<img class="reset-img" height="100" src="../../assets/istanbuljs.png" />
				</div>
			</section>
			<section data-transition="none-in slide-out">
				<img class="reset-img" height="100" src="../../assets/jest.png" />
				<div style="display: inline-block;width:4px;height:100px;background:#eee;margin:15px 0"></div>
				<div style="display:inline-block; opacity: 0.3;">
					<img class="reset-img" height="100" src="../../assets/chaijs.png" />
					<img class="reset-img" height="100" src="../../assets/karma.svg" />
					<img class="reset-img" height="100" src="../../assets/jasmine.png" />
					<img class="reset-img" height="100" src="../../assets/mocha.svg" />
					<img class="reset-img" height="100" src="../../assets/phantomjs.png" />
					<img class="reset-img" height="100" src="../../assets/istanbuljs.png" />
				</div>
			</section>
			<section>
				<h4>Installation</h4>
				<pre>
					<code class="language-sh" data-trim data-noescape>
						npm i -D jest @types/jest ts-jest typescript
						npx ts-jest config:init</code></pre>
				<p>And that's it!</p>
			</section>
			<section>
				<h4>Running Tests</h4>
				<pre>
					<code class="language-sh" data-trim data-noescape>
						npx jest "&lt;path to file or folder with wildcard" 
					</code></pre>
					<p>or by</p>
				<p>Installing <a href="https://marketplace.visualstudio.com/items?itemName=Orta.vscode-jest">VS code addon</a></p>
			</section>
			<section>
				<h4>Spec file structure</h4>
				<pre><code class="language-javascript" data-trim>
describe('test unit', () => {
  beforeAll(() => {
    // once before the unit
  });
  beforeEach(() => {
    // once before every test
  });
  afterEach(() => {
    // once after every test
  });
  afterAll(() => {
    // once after the unit
  });
});
				</code></pre>
			</section>
			<section>
				<h4>Given, When, Then</h4>
				<small>Explicit is better than implicit.</small>
				<br>
				<div style="text-align: right; font-size:22px;padding-right:200px"><small><a href="https://peps.python.org/pep-0020/">PEP20 - Python Zen
							Code</a></small></div>
				<pre><code class="language-javascript" data-trim>
it('should calculate 115USD for 100USD money and 15% tip', () => {
  // given
  expect.hasAssertions();
  const calculator = new SimpleTipCalculator();

  // when
  const result = calculator.calc(100, 15);

  // then
  expect(result).toBe(115);
});
					</code></pre>
			</section>
			<section>
				<h4>Given</h4>
				<p>Initial configurations for the tests</p>
				<h4>When</h4>
				<p>Test action</p>
				<h4>Then</h4>
				<p>One (or more) assertions</p>
			</section>
			<section>
				<h4>Before Each</h4>
				<pre><code class="language-javascript" data-trim>
describe('simple calculator', () => {
  let calculator: SimpleTipCalculator;
  beforeEach(() => {
    calculator = new SimpleTipCalculator();
  });
  
  it('should calculate 115USD for 100USD money and 15% Tip', () => {
    // given
    expect.hasAssertions();
    // when
    const result = calculator.calc(100, 15);
    // then
    expect(result).toBe(115);
  });
});
				</code></pre>
			</section>
			<section>
				<h4>before / after</h4>
				<table class="noborder">
					<tr>
						<td>beforeEach</td>
						<td>-</td>
						<td>runs before every test</td>
					</tr>
					<tr>
						<td>afterEach</td>
						<td>-</td>
						<td>runs after every test</td>
					</tr>
					<tr>
						<td>beforeAll</td>
						<td>-</td>
						<td>runs before all tests</td>
					</tr>
					<tr>
						<td>afterAll</td>
						<td>-</td>
						<td>runs after all test</td>
					</tr>
				</table>
			</section>
			<section>
				<h4>Matchers</h4>
				<ul>
					<li>Truthiness</li>
					<li>Numbers</li>
					<li>Numbers</li>
					<li>Strings</li>
					<li>Arrays and iterables</li>
					<li>Exceptions</li>
				</ul>
			</section>
			<section>
				<h4>Truthness Matchers</h4>
				<pre><code class="language-javascript"  data-trim data-noescape>
					test('null', () => {
						const n = null;
						expect(n).toBeNull();
						expect(n).toBeDefined();
						expect(n).not.toBeUndefined();
						expect(n).not.toBeTruthy();
						expect(n).toBeFalsy();
					});
					</code></pre>
				</ul>
			</section>
			<section>
				<h4>Number Matchers</h4>
				<pre><code class="language-javascript" data-trim data-noescape>
				test('two plus two', () => {
					const value = 2 + 2;
					expect(value).toBeGreaterThan(3);
					expect(value).toBeGreaterThanOrEqual(3.5);
					expect(value).toBeLessThan(5);
					expect(value).toBeLessThanOrEqual(4.5);
			
					// toBe and toEqual are equivalent for numbers
					expect(value).toBe(4);
					expect(value).toEqual(4);
				});
				</code></pre>
			</section>
			
			<section>
				<h4>String Matchers</h4>
				<pre><code class="language-javascript" data-trim data-noescape>
					it('string matchers', () => {
						const message = 'Hello World';
						const greeting = 'hello world';
						const phrase = 'JavaScript is awesome';
						const name = 'Christoph';
				
						expect('team').not.toMatch(/I/);
						expect(name).toMatch(/stop/);
						expect(message).toBe('Hello World');
						expect(greeting).toMatch(/HELLO/i);
						expect(phrase.startsWith('JavaScript')).toBe(true);
						expect(phrase.endsWith('awesome')).toBe(true);
					});
				</code></pre>
			</section>
			
			<section>
				<h4>Array and Iterable Matchers</h4>
				<pre><code class="language-javascript" data-trim data-noescape>
				it('array and iterable matchers', () => {
					const shoppingList = [
						'diapers',
						'kleenex',
						'trash bags',
						'paper towels',
						'beer',
					];
			
					expect(shoppingList).toContain('beer');
					expect(new Set(shoppingList)).toContain('diapers');
				});
				</code></pre>
			</section>
			
			<section>
				<h4>Exception Matchers</h4>
				<pre><code class="language-javascript" data-trim data-noescape>
				it('exception matchers', () => {
					function compileAndroidCode() {
						throw new Error('you are using the wrong JDK');
					}
			
					expect(() => compileAndroidCode()).toThrow();
					expect(() => compileAndroidCode()).toThrow(Error);
					expect(() => compileAndroidCode()).toThrow('you are using the wrong JDK');
					expect(() => compileAndroidCode()).toThrow(/JDK/);
				});
				</code></pre>
			</section>
			
			<section>
				<h4>Asynchronous tests</h4>
				<pre><code class="language-javascript" data-trim data-noescape>
it('should read data from file ', (done)=>{
	// given
	const fr = new FileReader();

	//when
	fr.onData('file-under-test.txt', (data)=>{
		// then
		expect(data).toBe('some data from file');
		done();
	})
});
				</code></pre>
			</section>
			<section>
				<h4>Error Assertion with Asynchronous Code</h4>
				<pre><code class="language-javascript" data-trim data-noescape>
				it('should throw an error when reading a missing file', (done) => {
					// given
					const fr = new FileReader();
			
					// when
					fr.onError('missing-file.txt', (error) => {
						// then
						expect(error).toBeDefined();
						expect(error.message).toBe('File not found');
						done();
					});
				});
				</code></pre>
			</section>			
			<section>
				<h4>Asynchronous tests (async/await)</h4>
				<pre><code class="language-javascript">
it('should read data from file ', async ()=>{
	// given
	const fr = new FileReader();

	// when
	const data = await fr.onData('file-under-test.txt');

	// then
	expect(data).toBe('some data from file');
});
				</code></pre>
			</section>
			<section>
				<h4>Async testing for errors</h4>
				<pre class="language-javascript"><code data-line-numbers="2,8-10">
it('should test for error', async ()=>{
  // given
  const unit = new UnitUnderTest();
  
  // when
  // then
  await expect(unit.functionUnderTest.bind(unit, 'param')).rejects.toThrow();
  await expect(unit.functionUnderTest.bind(unit, 'param')).rejects.toThrowError();
  await expect(unit.functionUnderTest.bind(unit, 'param')).rejects.toThrow('error message');
});
				</code></pre>
			</section>
			<section>
				<h4>Code kata (bouldering) 🥋</h4>
				<div style="display: flex; flex-direction: row;">
					<img src="../../assets/bouldering.jpg" style="width:400px;" />
					<span style="text-align: left; padding-top:20px; padding-left:20px">A form of rock climbing that is
						performed on small rock formations or artificial rock walls without the use of ropes or
						harnesses.</span>
				</div>
			</section>
			<section>
				<div style="display:flex; flex-direction: row;">
					<div>
						<h5>Boulder ZONE hold</h5>
						<img src="../../assets/boulder-zone.jpg" height="319" />
					</div>
					<div>
						<h5>Boulder TOP hold</h5>
						<img src="../../assets/boulder-top.jpg" height="319"/>
					</div>
				</div>
			</section>
			<section>
				<h4>Competition rules - register attempt</h4>
				<ul>
					<li>Make count of every attempt (successfull or unsuccessful) to complete the boulder</li>
					<li>Mark on which attempt the zone has been reached</li>
					<li>Mark on which attempt the top has been reached</li>
					<li>Time is also an issue, but we'll leave it for now</li>
				</ul>
			</section>
			<section>
				<h4>Competition rules - Calculate winner</h4>
				<ol>
					<li>Minimum attempts to reach the top gives top place</li>
					<li>If attempts till top are equal then the minimum number of zone attempts gives top place</li>
					<li>If both top attempts and zone attempts are equal then minimum total attempts count gives top place</li>
					<li>function should output top 3 places for competitors</li>
				</ol>
			</section>
			<section>
				<h4>TDD Bonus</h4>
				<ul>
					<li>Write tests that check specific scenario</li>
					<li>Observe the test fail</li>
					<li>Write the minimum code needed for the test to pass</li>
				</ul>
			</section>
			<section>
				<h5>Implementation suggestion</h5>
				<pre><code>
export interface PlayerScore {
	playerName: string;
	tops: number;
	zones: number;
	zoneAttempts: number;
	boulderAttemps: number;
}

export function setScore(playerScore: PlayerScore) {

}

export function calculateWinOrder(): string[] {
    return [];
}
				</code></pre>
			</section>
		</div>
	</div>

	<script src="dist/reveal.js"></script>
	<script src="plugin/notes/notes.js"></script>
	<script src="plugin/markdown/markdown.js"></script>
	<script src="plugin/highlight/highlight.js"></script>
	<script>
		// More info about initialization & config:
		// - https://revealjs.com/initialization/
		// - https://revealjs.com/config/
		Reveal.initialize({
			hash: true,
			width: 1200,
			// Learn about plugins: https://revealjs.com/plugins/
			plugins: [RevealMarkdown, RevealHighlight, RevealNotes]
		});
	</script>
</body>

</html>